{"ast":null,"code":"import _regeneratorRuntime from\"/home/hardik/Code/nilkanthsolutions/react-excel-parse/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/hardik/Code/nilkanthsolutions/react-excel-parse/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/hardik/Code/nilkanthsolutions/react-excel-parse/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useTransition}from\"react\";import{read,utils}from\"xlsx\";import{Table}from\"reactstrap\";import{HEADERS}from\"../utils/constants\";// import XLFile from \"../data/77-Jamnagar-Rural -Data.xlsx\";\nimport XLFile from\"../data/data.xlsx\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ExlReader=function ExlReader(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),result=_useState2[0],setResult=_useState2[1];var _useTransition=useTransition(),_useTransition2=_slicedToArray(_useTransition,2),isPending=_useTransition2[0],startTransition=_useTransition2[1];var getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var file,wb,ws,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(XLFile);case 2:_context.next=4;return _context.sent.arrayBuffer();case 4:file=_context.sent;wb=read(file);ws=wb.Sheets[wb.SheetNames[0]];data=utils.sheet_to_json(ws);console.log(data);setResult(data);case 10:case\"end\":return _context.stop();}}},_callee);}));return function getData(){return _ref.apply(this,arguments);};}();useEffect(function(){startTransition(function(){getData();});},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-center my-2 fw-bold\",children:\"77 - Jamnagar Rular\"}),/*#__PURE__*/_jsxs(Table,{className:\"table table-bordered\",size:\"sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:HEADERS&&HEADERS.map(function(item,index){return/*#__PURE__*/_jsx(\"th\",{children:item},index);})})}),/*#__PURE__*/_jsx(\"tbody\",{children:result&&result.map(function(item,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.PART_NAME_EN}),/*#__PURE__*/_jsx(\"td\",{children:item.PSBUILDING_NAME_EN}),/*#__PURE__*/_jsx(\"td\",{children:item.SECTION_NAME_EN}),/*#__PURE__*/_jsx(\"td\",{children:item.FM_NAME_EN}),/*#__PURE__*/_jsx(\"td\",{children:item.LASTNAME_EN}),/*#__PURE__*/_jsx(\"td\",{children:item.RLN_FM_NM_EN}),/*#__PURE__*/_jsx(\"td\",{children:item.RLN_L_NM_EN}),/*#__PURE__*/_jsx(\"td\",{children:item.GENDER}),/*#__PURE__*/_jsx(\"td\",{children:item.AGE}),/*#__PURE__*/_jsx(\"td\",{children:item.PIN_CODE})]},index);})})]})]});};export default ExlReader;","map":{"version":3,"names":["useState","useEffect","useTransition","read","utils","Table","HEADERS","XLFile","ExlReader","result","setResult","isPending","startTransition","getData","fetch","arrayBuffer","file","wb","ws","Sheets","SheetNames","data","sheet_to_json","console","log","map","item","index","PART_NAME_EN","PSBUILDING_NAME_EN","SECTION_NAME_EN","FM_NAME_EN","LASTNAME_EN","RLN_FM_NM_EN","RLN_L_NM_EN","GENDER","AGE","PIN_CODE"],"sources":["/home/hardik/Code/nilkanthsolutions/react-excel-parse/frontend/src/container/ExlReader.js"],"sourcesContent":["import { useState, useEffect, useTransition } from \"react\";\nimport { read, utils } from \"xlsx\";\nimport { Table } from \"reactstrap\";\n\nimport { HEADERS } from \"../utils/constants\";\n\n// import XLFile from \"../data/77-Jamnagar-Rural -Data.xlsx\";\nimport XLFile from \"../data/data.xlsx\";\n\nconst ExlReader = () => {\n\tconst [result, setResult] = useState([]);\n\tconst [isPending, startTransition] = useTransition();\n\n\tconst getData = async () => {\n\t\tconst file = await (await fetch(XLFile)).arrayBuffer();\n\t\tconst wb = read(file);\n\t\tconst ws = wb.Sheets[wb.SheetNames[0]];\n\t\tconst data = utils.sheet_to_json(ws);\n\t\tconsole.log(data);\n\t\tsetResult(data);\n\t};\n\n\tuseEffect(() => {\n\t\tstartTransition(() => {\n\t\t\tgetData();\n\t\t});\n\t}, []);\n\n\treturn (\n\t\t<div>\n\t\t\t<p className=\"text-center my-2 fw-bold\">77 - Jamnagar Rular</p>\n\t\t\t<Table className=\"table table-bordered\" size=\"sm\">\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t{HEADERS &&\n\t\t\t\t\t\t\tHEADERS.map((item, index) => {\n\t\t\t\t\t\t\t\treturn <th key={index}>{item}</th>;\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{result &&\n\t\t\t\t\t\tresult.map((item, index) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<tr key={index}>\n\t\t\t\t\t\t\t\t\t<td>{item.PART_NAME_EN}</td>\n\t\t\t\t\t\t\t\t\t<td>{item.PSBUILDING_NAME_EN}</td>\n\t\t\t\t\t\t\t\t\t<td>{item.SECTION_NAME_EN}</td>\n\t\t\t\t\t\t\t\t\t<td>{item.FM_NAME_EN}</td>\n\t\t\t\t\t\t\t\t\t<td>{item.LASTNAME_EN}</td>\n\t\t\t\t\t\t\t\t\t<td>{item.RLN_FM_NM_EN}</td>\n\t\t\t\t\t\t\t\t\t<td>{item.RLN_L_NM_EN}</td>\n\t\t\t\t\t\t\t\t\t<td>{item.GENDER}</td>\n\t\t\t\t\t\t\t\t\t<td>{item.AGE}</td>\n\t\t\t\t\t\t\t\t\t<td>{item.PIN_CODE}</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t</tbody>\n\t\t\t</Table>\n\t\t</div>\n\t);\n};\n\nexport default ExlReader;\n"],"mappings":"4cAAA,OAASA,QAAQ,CAAEC,SAAS,CAAEC,aAAa,KAAQ,OAAO,CAC1D,OAASC,IAAI,CAAEC,KAAK,KAAQ,MAAM,CAClC,OAASC,KAAK,KAAQ,YAAY,CAElC,OAASC,OAAO,KAAQ,oBAAoB,CAE5C;AACA,MAAOC,OAAM,KAAM,mBAAmB,CAAC,wFAEvC,GAAMC,UAAS,CAAG,QAAZA,UAAS,EAAS,CACvB,cAA4BR,QAAQ,CAAC,EAAE,CAAC,wCAAjCS,MAAM,eAAEC,SAAS,eACxB,mBAAqCR,aAAa,EAAE,kDAA7CS,SAAS,oBAAEC,eAAe,oBAEjC,GAAMC,QAAO,4FAAG,+KACWC,MAAK,CAACP,MAAM,CAAC,6CAAEQ,WAAW,UAA9CC,IAAI,eACJC,EAAE,CAAGd,IAAI,CAACa,IAAI,CAAC,CACfE,EAAE,CAAGD,EAAE,CAACE,MAAM,CAACF,EAAE,CAACG,UAAU,CAAC,CAAC,CAAC,CAAC,CAChCC,IAAI,CAAGjB,KAAK,CAACkB,aAAa,CAACJ,EAAE,CAAC,CACpCK,OAAO,CAACC,GAAG,CAACH,IAAI,CAAC,CACjBX,SAAS,CAACW,IAAI,CAAC,CAAC,uDAChB,kBAPKR,QAAO,0CAOZ,CAEDZ,SAAS,CAAC,UAAM,CACfW,eAAe,CAAC,UAAM,CACrBC,OAAO,EAAE,CACV,CAAC,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,mBACC,oCACC,UAAG,SAAS,CAAC,0BAA0B,iCAAwB,cAC/D,MAAC,KAAK,EAAC,SAAS,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,wBAChD,oCACC,oBACEP,OAAO,EACPA,OAAO,CAACmB,GAAG,CAAC,SAACC,IAAI,CAAEC,KAAK,CAAK,CAC5B,mBAAO,oBAAiBD,IAAI,EAAZC,KAAK,CAAa,CACnC,CAAC,CAAC,EACC,EACE,cACR,uBACElB,MAAM,EACNA,MAAM,CAACgB,GAAG,CAAC,SAACC,IAAI,CAAEC,KAAK,CAAK,CAC3B,mBACC,mCACC,oBAAKD,IAAI,CAACE,YAAY,EAAM,cAC5B,oBAAKF,IAAI,CAACG,kBAAkB,EAAM,cAClC,oBAAKH,IAAI,CAACI,eAAe,EAAM,cAC/B,oBAAKJ,IAAI,CAACK,UAAU,EAAM,cAC1B,oBAAKL,IAAI,CAACM,WAAW,EAAM,cAC3B,oBAAKN,IAAI,CAACO,YAAY,EAAM,cAC5B,oBAAKP,IAAI,CAACQ,WAAW,EAAM,cAC3B,oBAAKR,IAAI,CAACS,MAAM,EAAM,cACtB,oBAAKT,IAAI,CAACU,GAAG,EAAM,cACnB,oBAAKV,IAAI,CAACW,QAAQ,EAAM,GAVhBV,KAAK,CAWT,CAEP,CAAC,CAAC,EACI,GACD,GACH,CAER,CAAC,CAED,cAAenB,UAAS"},"metadata":{},"sourceType":"module"}